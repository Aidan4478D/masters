## new labels

A good point was brought up to group the NYC vehicles into classes that represent 
similar emission 

1. Passenger cars - Light Vehicles
    - (Sedan / Coupe / Hatchback) => Sedan (all three types are considered one class)
    - (SUV / Crossover) => SUV
    - Taxis
    - NYPD Cruiser
2. Passenger cars - Utility vehicles
    - Pickup Truck
    - (NYPD SUV, FDNY SUV) ==> NYC SUV
3. Commercial / Service Vehicles
    - (Van / Minivan / Passenger Van) => Van
    - Ambulences
4. Public Transport / Heavy Duty
    - (School bus / MTA bus) => Bus
    - (Freight/Commercial, dump, tankers) => Truck
        - Commercial trucks can be like box tricks, semi-trailers, flatbeds, tankers
    - Delivery Trucks
    - Firetrucks
5. Two wheelers (motorcycle/scooter)


#### Things that could be added:
- Food trucks

#### notes:
- The big trucks are heavy polluters but they're classified by their weight and axle count
- [Trucks and Commercial Vehicle Classifications](https://www.nyc.gov/html/dot/html/motorist/truckorcomm.shtml)
- Truck definition in NYC:
    - A truck is defined as any vehicle or combination of vehicles designed for the transportation of property 
    - two axles and six tires, or three or more axles
- Commerical Vehicle definition
    - Vehicle designed, maintained, or used primarily for the transportation of property or for the provision of commercial services and bearing commercial plates is considered a commercial vehicle

#### Objective
Classification = identifies the main subject of an image
Object detection = locates multiple objects within an image using bounding boxes
Segmentation = provides a pixel-by-pixel outline of objects

In our case, we want to do object detection as there could be multiple of the same 
class vehicle on the screen at any point in time. 

#### Labeling
- This paper had an interesting labeling strategy [https://arxiv.org/pdf/2401.07322](https://arxiv.org/pdf/2401.07322) (2024)
    - **Manual annotation** ==> 4,000 manually annotated images using open-source Label Studio annotation tool
        - Images without objects from the specified 13 classes are discarded
        - If an object is occluded by more than roughly 50%, it is also omitted from annotation.
        - In cases where the object is visible, but still partially occluded, a box is drawn around the visible portion. 
        - The constraint to draw tight boxes is relaxed in dense and cluttered scenes to capture real-world characteristics.
        - Average annotation time = 48 seconds
    - **Semi-Automatic Annotation** ==> 1,000 validation images, 650 test set
        - Train YOLOv6-M6using the labeled data from manual annotation
        - Through inference, bounding box predictions are generated for the classes within the validation and test sets
        - Annotators then adjusting bounding boxes tightly around objects and correct any inaccurate labels predicted by the model
        - Average annotation time = 8 seconds
    - **Fully Automatic Annotation**
        - We employ YOLOv6-M6, previously trained on images with bounding box labels to pseudo-label unlabeled images
        - A.k.a use model to pseudo-label unseen images
        - After filtering out images with null predictions, we obtain 14,696 pseudo-labeled images.
    - Predicts both the box coordinates and the class label for objects
    - Could be a useful pipeline in our case to enable automatic labeling

- As for manual labeling, this site seems good: [https://www.makesense.ai/](https://www.makesense.ai/)
    - Free and very easy to use

#### How to differentiate between passenger cars
- I feel like coupes and sedans are easy to differentiate when compared to something like an SUV
- I feel like hatchbacks look a lot more similar to SUVs
    - Can't group them together as the footprint is more similar to that of a sedan
    - Need a way of consistently differentiating between an SUV and a hatchback
- Especially difficult when resolution is so low and some cars are far away

Going to label sedan UNLESS (2) of these are satisfied:
- Car height + wheel gap: more ground clearance; bigger gap above tires.
- Hood height: thicker, taller front end.
- Roof rails / black cladding around wheel arches (common).
- Boxier rear: near-vertical tailgate, taller cargo area.

#### Different models that can be fine-tuned
**RT-DETR** [https://github.com/lyuwenyu/RT-DETR](https://github.com/lyuwenyu/RT-DETR)
- Real time detection transformers
- Able to perform well in "complex scenarios" and "difficult conditions"
**YOLO Model family**
- YOLOv11 generally offers the best performance
- YOLOv8 is a strong, mature, and widely supported choice with a great balance of speed and accuracy
**DINOv3** [https://ai.meta.com/dinov3/](https://ai.meta.com/dinov3/)
- Just read a paper on this for the Deep Learning class
- Uses "self-supervised learning" to create dense and rich feature maps that don't degrade over training time
- "During pre-training, the model learns general-purpose visual representations, matching features between different augmented views of the same image"
- "A pre-trained DINOv3 model can be easily tailored by training a lightweight adapter on a small amount of annotated data."
- Can download the model/distilled models here: [https://github.com/facebookresearch/dinov3](https://github.com/facebookresearch/dinov3)

#### Upscaling images
- Want to try upsampling the image so the resolution becomes better
- Real-ESRGAN has some promising results [https://github.com/xinntao/Real-ESRGAN](https://github.com/xinntao/Real-ESRGAN)

